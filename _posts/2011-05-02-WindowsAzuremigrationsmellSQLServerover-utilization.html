---
layout: post
tags: [Azure, Software Design]
date: 2011-05-02 12:23:49 UTC
title: "Windows Azure migration smell: SQL Server over-utilization"
comments: true
---
{% include JB/setup %}

<div id="post">
	<p>Recently I partook in a Windows Azure migration workshop, helping developers from existing development organizations port their applications to Windows Azure. Once more an old design smell popped up: <em>SQL Server over-utilization</em>. This ought to be old news to anyone with experience designing software on the Wintel stack, but apparently it bears repetition:</p> <blockquote> <p>Don't put logic in your database. SQL Server should be used only for persistent storage of data.</p></blockquote> <p>(Yes: this post <em>is</em> written in 2011…)</p> <p>Many years ago I heard that role described as a ‘bit bucket'  -  you put in data and pull it out again, and that's all you do. No fancy stored procedures or functions or triggers.</p> <p>Why wouldn't we want to use the database if we have one? Scalability is the answer. SQL Server doesn't scale horizontally. You can't add more servers to take the load off a database server (well, some of my old colleagues will argue that this is possible with Oracle, and that may be true, but with SQL Server it's impossible).</p> <p>Yes, we can jump through hoops like partitioning and splitting the database up into several smaller databases, but it still doesn't give us horizontal scalability. SQL Server is a bottleneck in any system in which it takes part.</p> <p>How is this relevant to Windows Azure? It's relevant for two important reasons:</p> <ul> <li>There's an upper size limit on SQL Azure. Currently that size limit is 50 GB, and while it's likely to grow in the future, there's going to be a ceiling for a long time.  <li>You can't fine tune the hardware for performance. The server runs on virtual hardware.</li></ul> <p>Development organizations that rely heavily on the database for execution of logic often need expensive hardware and experienced DBAs to squeeze extra performance out of the database servers. Such people know that write-intensive/append-only tables work best with one type of RAID, while read-intensive tables are better hosted on other file groups on different disks with different RAID configurations.</p> <p>With SQL Azure you can just forget about all that.</p> <p>The bottom line is that there are fundamental rules for software development that you must follow if you want to be able to successfully migrate to Windows Azure. I previously described an <a href="http://blog.ploeh.dk/2010/10/14/WindowsAzureMigrationSanityCheck.aspx">even simpler sanity check you should perform</a>, but after that you should take a good look at your database.</p> <p>The best solution is if you can completely replace SQL Server with Azure's very scalable storage services, but those <a href="http://blog.ploeh.dk/2011/01/24/ScalableDoesntMeanFast.aspx">come with their own set of challenges</a>.</p>
</div>
	