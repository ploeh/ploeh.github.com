---
layout: post
tags: [Dependency Injection]
date: 2010-12-24 09:29:06 UTC
title: "Challenge: Resolve closed types with MEF"
comments: true
---
{% include JB/setup %}

<div id="post">
	<p>For my international reader, a bit of context is in order for this post: Microsoft Denmark sponsors a series of Christmas challenges known as the Microsoft Christmas Calendar. Different bloggers alternate hosting a coding challenge for the day, and Microsoft sponsors the prizes.</p> <p>Today I have the honor of hosting the last challenge for 2010. Contestants from the Danish .NET community have the opportunity to win a <a href="http://www.thinkgeek.com/homeoffice/kitchen/c2b1/">Molecular Gastronomy Starter Kit</a>  -  if any of my international readers feel like joining in, they are welcome, but (probably) not eligible for the prize.</p> <p><strong>The challenge</strong></p> <p>The <a href="http://mef.codeplex.com/">Managed Extensibility Framework</a> (MEF) enables us to compose applications by annotating types and members with [Import] and [Export] attributes, but what can you do when you have types without these attributes and you can't add the attributes?</p> <p>For example, how can we compose Mayonnaise from these three classes?</p><!--
{\rtf\ansi{\fonttbl{\f0 Consolas;}}{\colortbl;\red0\green0\blue255;\red43\green145\blue175;\red163\green21\blue21;}\f0 \fs19 \cf1 public\cf0  \cf1 sealed\cf0  \cf1 class\cf0  \cf2 EggYolk\cf0  \{ \}\par \par \cf1 public\cf0  \cf1 sealed\cf0  \cf1 class\cf0  \cf2 OliveOil\cf0  \{ \}\par \par \cf1 public\cf0  \cf1 sealed\cf0  \cf1 class\cf0  \cf2 Mayonnaise\cf0 \par \{\par     \cf1 private\cf0  \cf1 readonly\cf0  \cf2 EggYolk\cf0  eggYolk;\par     \cf1 private\cf0  \cf1 readonly\cf0  \cf2 OliveOil\cf0  oil;\par \par     \cf1 public\cf0  Mayonnaise(\cf2 EggYolk\cf0  eggYolk, \cf2 OliveOil\cf0  oil)\par     \{\par         \cf1 if\cf0  (eggYolk == \cf1 null\cf0 )\par         \{\par             \cf1 throw\cf0  \cf1 new\cf0  \cf2 ArgumentNullException\cf0 (\cf3 "eggYolk"\cf0 );\par         \}\par         \cf1 if\cf0  (oil == \cf1 null\cf0 )\par         \{\par             \cf1 throw\cf0  \cf1 new\cf0  \cf2 ArgumentNullException\cf0 (\cf3 "oil"\cf0 );\par         \}\par \par         \cf1 this\cf0 .eggYolk = eggYolk;\par         \cf1 this\cf0 .oil = oil;\par     \}\par \par     \cf1 public\cf0  \cf2 EggYolk\cf0  EggYolk\par     \{\par         \cf1 get\cf0  \{ \cf1 return\cf0  \cf1 this\cf0 .eggYolk; \}\par     \}\par \par     \cf1 public\cf0  \cf2 OliveOil\cf0  Oil\par     \{\par         \cf1 get\cf0  \{ \cf1 return\cf0  \cf1 this\cf0 .oil; \}\par     \}\par \}\par }
--> <div style="font-family: consolas; background: none repeat scroll 0% 0% white; color: black; font-size: 10pt;"><pre style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">sealed</span> <span style="color: blue;">class</span> <span style="color: rgb(43, 145, 175);">EggYolk</span> { }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">sealed</span> <span style="color: blue;">class</span> <span style="color: rgb(43, 145, 175);">OliveOil</span> { }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;"><span style="color: blue;">public</span> <span style="color: blue;">sealed</span> <span style="color: blue;">class</span> <span style="color: rgb(43, 145, 175);">Mayonnaise</span></pre><pre style="margin: 0px;">{</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">readonly</span> <span style="color: rgb(43, 145, 175);">EggYolk</span> eggYolk;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">private</span> <span style="color: blue;">readonly</span> <span style="color: rgb(43, 145, 175);">OliveOil</span> oil;</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> Mayonnaise(<span style="color: rgb(43, 145, 175);">EggYolk</span> eggYolk, <span style="color: rgb(43, 145, 175);">OliveOil</span> oil)</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (eggYolk == <span style="color: blue;">null</span>)</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">throw</span> <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">ArgumentNullException</span>(<span style="color: rgb(163, 21, 21);">"eggYolk"</span>);</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (oil == <span style="color: blue;">null</span>)</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">throw</span> <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">ArgumentNullException</span>(<span style="color: rgb(163, 21, 21);">"oil"</span>);</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">this</span>.eggYolk = eggYolk;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">this</span>.oil = oil;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: rgb(43, 145, 175);">EggYolk</span> EggYolk</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">get</span> { <span style="color: blue;">return</span> <span style="color: blue;">this</span>.eggYolk; }</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: rgb(43, 145, 175);">OliveOil</span> Oil</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">get</span> { <span style="color: blue;">return</span> <span style="color: blue;">this</span>.oil; }</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">}</pre></div>
<p>The challenge is to come up with a good solution to that problem. Here are the formal rules:</p>
<ul>
<li>The unit test suite at the end of this post must pass. 
</li><li>You are not allowed to edit the unit tests. 
</li><li>You are only allowed to add <em>one</em> (1) <em>using</em> directive to the unit test file to reference the namespace of your proposed solution. 
</li><li>You must work from the Visual Studio 2010 solution attached to this post. Add a new project that contains your solution. Send me the solution in a .zip file to enter the contest. 
</li><li>You are allowed to implement your solution in <em>any language</em> you would like as long as it compiles and runs from Visual Studio 2010 Premium. 
</li><li>The winner is chosen by my subjective judgment, but I will emphasize clean code and design. A tip: attempt to get as good scores as possible from Visual Studio's <em>Code Analysis</em> and <em>Code Metrics</em>. Good scores does not guarantee that you win, but bad scores will most likely ensure that you don't. 
</li><li>Since many of you are on Christmas vacation the deadline is this year. As long as you submit a solution in 2010 (Danish time) you're a contestant.</li></ul>
<p>There are lots of different ways to skin this cat, so I'm looking forward to your submissions to see all your creative solutions.</p>
<p>This unit test suite is the specification:</p><!--
{\rtf\ansi{\fonttbl{\f0 Consolas;}}{\colortbl;\red0\green0\blue255;\red43\green145\blue175;}\f0 \fs19 \cf1 using\cf0  System.ComponentModel.Composition.Hosting;\par \cf1 using\cf0  Ploeh.Samples.MeffyXmas.MenuModel;\par \cf1 using\cf0  Xunit;\par \par \cf1 namespace\cf0  Ploeh.Samples.MeffyXmas.MefMenu.UnitTest\par \{\par     \cf1 public\cf0  \cf1 class\cf0  \cf2 ContainerBuilderFacts\cf0 \par     \{\par         [\cf2 Fact\cf0 ]\par         \cf1 public\cf0  \cf1 void\cf0  DefaultContainerCorrectlyResolvesOliveOil()\par         \{\par             \cf2 CompositionContainer\cf0  container = \cf1 new\cf0  \cf2 ContainerBuilder\cf0 ()\par                 .Build();\par             \cf1 var\cf0  oil = container.GetExportedValue&lt;\cf2 OliveOil\cf0 &gt;();\par             \cf2 Assert\cf0 .NotNull(oil);\par         \}\par \par         [\cf2 Fact\cf0 ]\par         \cf1 public\cf0  \cf1 void\cf0  DefaultContainerCorrectlyResolvesEggYolk()\par         \{\par             \cf2 CompositionContainer\cf0  container = \cf1 new\cf0  \cf2 ContainerBuilder\cf0 ()\par                 .Build();\par             \cf1 var\cf0  yolk = container.GetExportedValue&lt;\cf2 EggYolk\cf0 &gt;();\par             \cf2 Assert\cf0 .NotNull(yolk);\par         \}\par \par         [\cf2 Fact\cf0 ]\par         \cf1 public\cf0  \cf1 void\cf0  DefaultContainerCorrectlyResolvesMayonnaise()\par         \{\par             \cf2 CompositionContainer\cf0  container = \cf1 new\cf0  \cf2 ContainerBuilder\cf0 ()\par                 .Build();\par             \cf1 var\cf0  mayo = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf2 Assert\cf0 .NotNull(mayo);\par         \}\par \par         [\cf2 Fact\cf0 ]\par         \cf1 public\cf0  \cf1 void\cf0  DefaultContainerReturnsSingletonMayonnaise()\par         \{\par             \cf2 CompositionContainer\cf0  container = \cf1 new\cf0  \cf2 ContainerBuilder\cf0 ()\par                 .Build();\par             \cf1 var\cf0  mayo1 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf1 var\cf0  mayo2 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf2 Assert\cf0 .Same(mayo1, mayo2);\par         \}\par \par         [\cf2 Fact\cf0 ]\par         \cf1 public\cf0  \cf1 void\cf0  WithTransientMayonnaiseReturnTransientMayonnaise()\par         \{\par             \cf2 CompositionContainer\cf0  container = \cf1 new\cf0  \cf2 ContainerBuilder\cf0 ()\par                 .WithNonSharedMayonnaise()\par                 .Build();\par             \cf1 var\cf0  mayo1 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf1 var\cf0  mayo2 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf2 Assert\cf0 .NotSame(mayo1, mayo2);\par         \}\par \par         [\cf2 Fact\cf0 ]\par         \cf1 public\cf0  \cf1 void\cf0  TransientMayonnaiseByDefaultContainsSingletonEggYolk()\par         \{\par             \cf2 CompositionContainer\cf0  container = \cf1 new\cf0  \cf2 ContainerBuilder\cf0 ()\par                 .WithNonSharedMayonnaise()\par                 .Build();\par             \cf1 var\cf0  mayo1 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf1 var\cf0  mayo2 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf2 Assert\cf0 .Same(mayo1.EggYolk, mayo2.EggYolk);\par         \}\par \par         [\cf2 Fact\cf0 ]\par         \cf1 public\cf0  \cf1 void\cf0  TransientMayonnaiseByDefaultContainsSingletonOil()\par         \{\par             \cf2 CompositionContainer\cf0  container = \cf1 new\cf0  \cf2 ContainerBuilder\cf0 ()\par                 .WithNonSharedMayonnaise()\par                 .Build();\par             \cf1 var\cf0  mayo1 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf1 var\cf0  mayo2 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf2 Assert\cf0 .Same(mayo1.Oil, mayo2.Oil);\par         \}\par \par         [\cf2 Fact\cf0 ]\par         \cf1 public\cf0  \cf1 void\cf0  TransientMayonnaiseCanHaveTransientEggYolk()\par         \{\par             \cf2 CompositionContainer\cf0  container = \cf1 new\cf0  \cf2 ContainerBuilder\cf0 ()\par                 .WithNonSharedMayonnaise()\par                 .WithNonSharedEggYolk()\par                 .Build();\par             \cf1 var\cf0  mayo1 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf1 var\cf0  mayo2 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf2 Assert\cf0 .NotSame(mayo1.EggYolk, mayo2.EggYolk);\par         \}\par \par         [\cf2 Fact\cf0 ]\par         \cf1 public\cf0  \cf1 void\cf0  TransientMayonnaiseCanHaveSingletonOil()\par         \{\par             \cf2 CompositionContainer\cf0  container = \cf1 new\cf0  \cf2 ContainerBuilder\cf0 ()\par                 .WithNonSharedMayonnaise()\par                 .WithNonSharedEggYolk()\par                 .Build();\par             \cf1 var\cf0  mayo1 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf1 var\cf0  mayo2 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf2 Assert\cf0 .Same(mayo1.Oil, mayo2.Oil);\par         \}\par \par         [\cf2 Fact\cf0 ]\par         \cf1 public\cf0  \cf1 void\cf0  TransientMayonnaiseCanHaveTransientOil()\par         \{\par             \cf2 CompositionContainer\cf0  container = \cf1 new\cf0  \cf2 ContainerBuilder\cf0 ()\par                 .WithNonSharedMayonnaise()\par                 .WithNonSharedOil()\par                 .Build();\par             \cf1 var\cf0  mayo1 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf1 var\cf0  mayo2 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf2 Assert\cf0 .NotSame(mayo1.Oil, mayo2.Oil);\par         \}\par \par         [\cf2 Fact\cf0 ]\par         \cf1 public\cf0  \cf1 void\cf0  TransientMayonnaiseCanHaveSingletonEggYolk()\par         \{\par             \cf2 CompositionContainer\cf0  container = \cf1 new\cf0  \cf2 ContainerBuilder\cf0 ()\par                 .WithNonSharedMayonnaise()\par                 .WithNonSharedOil()\par                 .Build();\par             \cf1 var\cf0  mayo1 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf1 var\cf0  mayo2 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf2 Assert\cf0 .Same(mayo1.EggYolk, mayo2.EggYolk);\par         \}\par \par         [\cf2 Fact\cf0 ]\par         \cf1 public\cf0  \cf1 void\cf0  PureTransientMayonnaiseIsTransient()\par         \{\par             \cf2 CompositionContainer\cf0  container = \cf1 new\cf0  \cf2 ContainerBuilder\cf0 ()\par                 .WithNonSharedMayonnaise()\par                 .WithNonSharedEggYolk()\par                 .WithNonSharedOil()\par                 .Build();\par             \cf1 var\cf0  mayo1 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf1 var\cf0  mayo2 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf2 Assert\cf0 .NotSame(mayo1, mayo2);\par         \}\par \par         [\cf2 Fact\cf0 ]\par         \cf1 public\cf0  \cf1 void\cf0  PureTransientMayonnaiseHasTransientEggYolk()\par         \{\par             \cf2 CompositionContainer\cf0  container = \cf1 new\cf0  \cf2 ContainerBuilder\cf0 ()\par                 .WithNonSharedMayonnaise()\par                 .WithNonSharedEggYolk()\par                 .WithNonSharedOil()\par                 .Build();\par             \cf1 var\cf0  mayo1 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf1 var\cf0  mayo2 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf2 Assert\cf0 .NotSame(mayo1.EggYolk, mayo2.EggYolk);\par         \}\par \par         [\cf2 Fact\cf0 ]\par         \cf1 public\cf0  \cf1 void\cf0  PureTransientMayonnaiseHasTransientOil()\par         \{\par             \cf2 CompositionContainer\cf0  container = \cf1 new\cf0  \cf2 ContainerBuilder\cf0 ()\par                 .WithNonSharedMayonnaise()\par                 .WithNonSharedEggYolk()\par                 .WithNonSharedOil()\par                 .Build();\par             \cf1 var\cf0  mayo1 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf1 var\cf0  mayo2 = container.GetExportedValue&lt;\cf2 Mayonnaise\cf0 &gt;();\par             \cf2 Assert\cf0 .NotSame(mayo1.Oil, mayo2.Oil);\par         \}\par     \}\par \}\par }
-->
<div style="font-family: consolas; background: none repeat scroll 0% 0% white; color: black; font-size: 10pt;"><pre style="margin: 0px;"><span style="color: blue;">using</span> System.ComponentModel.Composition.Hosting;</pre><pre style="margin: 0px;"><span style="color: blue;">using</span> Ploeh.Samples.MeffyXmas.MenuModel;</pre><pre style="margin: 0px;"><span style="color: blue;">using</span> Xunit;</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;"><span style="color: blue;">namespace</span> Ploeh.Samples.MeffyXmas.MefMenu.UnitTest</pre><pre style="margin: 0px;">{</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">class</span> <span style="color: rgb(43, 145, 175);">ContainerBuilderFacts</span></pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color: rgb(43, 145, 175);">Fact</span>]</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> DefaultContainerCorrectlyResolvesOliveOil()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">CompositionContainer</span> container = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">ContainerBuilder</span>()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Build();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> oil = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">OliveOil</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">Assert</span>.NotNull(oil);</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color: rgb(43, 145, 175);">Fact</span>]</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> DefaultContainerCorrectlyResolvesEggYolk()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">CompositionContainer</span> container = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">ContainerBuilder</span>()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Build();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> yolk = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">EggYolk</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">Assert</span>.NotNull(yolk);</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color: rgb(43, 145, 175);">Fact</span>]</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> DefaultContainerCorrectlyResolvesMayonnaise()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">CompositionContainer</span> container = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">ContainerBuilder</span>()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Build();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">Assert</span>.NotNull(mayo);</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color: rgb(43, 145, 175);">Fact</span>]</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> DefaultContainerReturnsSingletonMayonnaise()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">CompositionContainer</span> container = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">ContainerBuilder</span>()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Build();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo1 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo2 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">Assert</span>.Same(mayo1, mayo2);</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color: rgb(43, 145, 175);">Fact</span>]</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> WithTransientMayonnaiseReturnTransientMayonnaise()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">CompositionContainer</span> container = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">ContainerBuilder</span>()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedMayonnaise()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Build();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo1 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo2 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">Assert</span>.NotSame(mayo1, mayo2);</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color: rgb(43, 145, 175);">Fact</span>]</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> TransientMayonnaiseByDefaultContainsSingletonEggYolk()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">CompositionContainer</span> container = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">ContainerBuilder</span>()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedMayonnaise()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Build();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo1 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo2 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">Assert</span>.Same(mayo1.EggYolk, mayo2.EggYolk);</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color: rgb(43, 145, 175);">Fact</span>]</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> TransientMayonnaiseByDefaultContainsSingletonOil()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">CompositionContainer</span> container = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">ContainerBuilder</span>()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedMayonnaise()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Build();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo1 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo2 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">Assert</span>.Same(mayo1.Oil, mayo2.Oil);</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color: rgb(43, 145, 175);">Fact</span>]</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> TransientMayonnaiseCanHaveTransientEggYolk()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">CompositionContainer</span> container = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">ContainerBuilder</span>()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedMayonnaise()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedEggYolk()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Build();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo1 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo2 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">Assert</span>.NotSame(mayo1.EggYolk, mayo2.EggYolk);</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color: rgb(43, 145, 175);">Fact</span>]</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> TransientMayonnaiseCanHaveSingletonOil()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">CompositionContainer</span> container = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">ContainerBuilder</span>()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedMayonnaise()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedEggYolk()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Build();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo1 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo2 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">Assert</span>.Same(mayo1.Oil, mayo2.Oil);</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color: rgb(43, 145, 175);">Fact</span>]</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> TransientMayonnaiseCanHaveTransientOil()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">CompositionContainer</span> container = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">ContainerBuilder</span>()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedMayonnaise()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedOil()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Build();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo1 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo2 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">Assert</span>.NotSame(mayo1.Oil, mayo2.Oil);</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color: rgb(43, 145, 175);">Fact</span>]</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> TransientMayonnaiseCanHaveSingletonEggYolk()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">CompositionContainer</span> container = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">ContainerBuilder</span>()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedMayonnaise()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedOil()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Build();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo1 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo2 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">Assert</span>.Same(mayo1.EggYolk, mayo2.EggYolk);</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color: rgb(43, 145, 175);">Fact</span>]</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> PureTransientMayonnaiseIsTransient()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">CompositionContainer</span> container = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">ContainerBuilder</span>()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedMayonnaise()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedEggYolk()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedOil()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Build();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo1 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo2 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">Assert</span>.NotSame(mayo1, mayo2);</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color: rgb(43, 145, 175);">Fact</span>]</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> PureTransientMayonnaiseHasTransientEggYolk()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">CompositionContainer</span> container = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">ContainerBuilder</span>()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedMayonnaise()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedEggYolk()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedOil()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Build();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo1 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo2 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">Assert</span>.NotSame(mayo1.EggYolk, mayo2.EggYolk);</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [<span style="color: rgb(43, 145, 175);">Fact</span>]</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">public</span> <span style="color: blue;">void</span> PureTransientMayonnaiseHasTransientOil()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">CompositionContainer</span> container = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">ContainerBuilder</span>()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedMayonnaise()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedEggYolk()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .WithNonSharedOil()</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Build();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo1 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue;">var</span> mayo2 = container.GetExportedValue&lt;<span style="color: rgb(43, 145, 175);">Mayonnaise</span>&gt;();</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: rgb(43, 145, 175);">Assert</span>.NotSame(mayo1.Oil, mayo2.Oil);</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px;">}</pre></div>
<p>ContainerBuilder is the class you must implement, so the unit tests don't compile until you make them. Meffy xmas!</p>
<p><img style="background-image: none; border-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px;" title="clip_image002" alt="clip_image002" src="http://blog.ploeh.dk/content/binary/Windows-Live-Writer/ResolveclosedtypeswithMEF_BD03/clip_image002_3.jpg" border="0" height="182" width="640"></p>
</div>
	